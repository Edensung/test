from selenium import webdriver
import time
import pyautogui
import os
# 打开Chrome浏览器
driver = webdriver.Chrome()

# 打开指定网页
url = "https://github.com/Alvin9999/new-pac/wiki/v2ray%E5%85%8D%E8%B4%B9%E8%B4%A6%E5%8F%B7"
driver.get(url)

# 最大化浏览器窗口
driver.maximize_window()

# 模拟按下 Page Down 键 1 次
for i in range(1):
    pyautogui.press('pagedown')
    time.sleep(1)

# 等待页面加载完全
time.sleep(5)

# 截取当前屏幕并保存到本地磁盘
image = pyautogui.screenshot()
image.save("screenshot.png")

# 关闭浏览器
driver.quit()





#自动关机模块

#os.system("shutdown /s /t 10")


#尽量每个模块各自import，可以重复利用。
import time
import os
import sys
import msvcrt

print("电脑将在100秒后关机。按下任意键取消操作。")
for i in range(100, 0, -1):
    if os.name == "nt":
        time.sleep(1)
    else:
        time.sleep(1)
    if os.name == "nt" and msvcrt.kbhit():
        print("取消关机操作。")
        os.system("shutdown /a")
        break
    elif os.name != "nt":
        import select
        i, o, e = select.select([sys.stdin], [], [], 0.1)
        if i:
            print("取消关机操作。")
            os.system("shutdown -c")
            break
else:
    print("正在关机...")
    os.system("shutdown /s /t 0")
#自动关机结束


